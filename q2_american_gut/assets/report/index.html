{% extends "base.html" %}
<!--

  Expected inputs for this template
  =================================

  reporter_view, object in charge of creating the plots for a given reporter.
  For more details see _reporter.py

  The layout of the divs and tabs has been based on the classes described
  in these examples:
  https://www.w3schools.com/bootstrap/bootstrap_tabs_pills.asp
-->

{% block head %}
  <title>American Gut Report</title>
  <!-- TODO: revise if we actually need underscore, add bootstrap if needed -->
  <script src="./resources/vendor/js/underscore-min.js"></script>
{% endblock %}

{% block content %}
  <h1>American Gut Report for samples: {{ name }}</h1>
  <img src='./resources/ag_logo.png' alt='American Gut Logo'>

  <!-- top level subject's list -->
  <ul name='hosts'>
  {% for host_id, host_type, _ in reporter_view.reporter.iter_subjects() %}
    <li>
      <a  href="#{{host_id}}-{{host_type}}" data-toggle="tab">{{host_id}}</a>
    </li>
  {% endfor%}
  </ul>

  <!-- div containers for the subjects -->
  {% for host_id, host_type, subset in reporter_view.reporter.iter_subjects() %}
    <div class="tab-pane" id="{{host_id}}-{{host_type}}">

      <!-- for loop for the per-subject plots -->
      <ul name='sample-types'>
      {% for sample_type, _ in reporter_view.reporter.iter_sample_types(subset) %}
        <li>
          <a  href="#{{host_id}}-{{host_type}}-{{sample_type}}" data-toggle="tab">{{sample_type}}</a>
        </li>
      {% endfor%}
      </ul>

      {# st is the sample type subset, should only include a subject's samples #}
      {% for sample_type, st_subset in reporter_view.reporter.iter_sample_types(subset) %}
        <div class="tab-pane" id="{{host_id}}-{{host_type}}-{{sample_type}}">
          {{reporter_view.render_plots(st_subset)}}
        </div>
      {% endfor%}

    </div>
  {% endfor%}

{% endblock %}
